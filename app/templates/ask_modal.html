<!-- Ask Modal -->
<div id="ask-modal" class="fixed inset-0 z-50 flex items-center justify-center modal-backdrop"
    style="background-color: rgba(0, 0, 0, 0.5);" onclick="if(event.target === this) this.remove()">
    <div class="w-full max-w-4xl h-[85vh] flex flex-col rounded-2xl shadow-2xl mx-4"
        style="background-color: var(--color-bg-primary);" onclick="event.stopPropagation()">

        <!-- Header -->
        <div class="flex items-center justify-between p-5 border-b" style="border-color: var(--color-border);">
            <div class="flex items-center gap-3">
                <div class="p-2 rounded-xl"
                    style="background: linear-gradient(135deg, var(--color-accent-primary), var(--color-accent-hover));">
                    <svg class="w-6 h-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                </div>
                <div>
                    <h2 class="text-xl font-bold">Ask About Your Notes</h2>
                    <p class="text-sm" style="color: var(--color-text-secondary);">Get AI-powered answers from your
                        voice notes</p>
                </div>
            </div>
            <button onclick="document.getElementById('ask-modal').remove()"
                class="p-2 rounded-lg transition hover:opacity-70" style="color: var(--color-text-secondary);">
                <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </button>
        </div>

        <!-- Chat Area -->
        <div id="chat-messages" class="flex-1 overflow-y-auto p-6 space-y-6">
            <!-- Welcome Message -->
            <div class="flex items-start gap-4">
                <div class="p-2 rounded-xl shrink-0" style="background-color: var(--color-bg-tertiary);">
                    <svg class="w-6 h-6" style="color: var(--color-accent-primary);" fill="none" viewBox="0 0 24 24"
                        stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
                    </svg>
                </div>
                <div class="flex-1 p-4 rounded-xl" style="background-color: var(--color-bg-secondary);">
                    <p class="mb-2">ðŸ‘‹ <strong>Welcome!</strong> I can help you find information in your voice notes.
                    </p>
                    <p class="text-sm" style="color: var(--color-text-secondary);">Try asking questions like:</p>
                    <ul class="text-sm mt-2 space-y-1" style="color: var(--color-text-secondary);">
                        <li>â€¢ "What were my todo items from last week?"</li>
                        <li>â€¢ "Summarize my notes about the project meeting"</li>
                        <li>â€¢ "What ideas did I have about..."</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Input Form -->
        <div class="p-5 border-t" style="border-color: var(--color-border);">
            <form hx-post="/web/ask" hx-target="#chat-messages" hx-swap="beforeend scroll:bottom"
                hx-on::before-request="this.querySelector('button[type=submit]').disabled = true"
                hx-on::after-request="this.reset(); this.querySelector('button[type=submit]').disabled = false"
                class="flex gap-3">
                <input type="text" name="question" placeholder="Ask a question about your notes..."
                    class="flex-1 px-5 py-3 rounded-xl border text-lg"
                    style="border-color: var(--color-border); background-color: var(--color-bg-secondary);" required
                    autofocus />
                <button type="submit"
                    class="px-6 py-3 rounded-xl font-semibold text-white transition flex items-center gap-2"
                    style="background: linear-gradient(135deg, var(--color-accent-primary), var(--color-accent-hover));">
                    <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M14 5l7 7m0 0l-7 7m7-7H3" />
                    </svg>
                    Send
                </button>
            </form>
        </div>

    </div>
</div>